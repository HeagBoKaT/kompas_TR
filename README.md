# Редактор технических требований для KOMPAS-3D

## Описание
Эта программа позволяет редактировать и вставлять типовые тексты в технические требования чертежей KOMPAS-3D. Она предоставляет удобный интерфейс для быстрого доступа к часто используемым шаблонам технических требований, которые хранятся в файле JSON.

## Функциональность
- Подключение к API KOMPAS-3D
- Отображение информации о текущем активном документе
- Отображение дерева всех открытых в KOMPAS-3D документов
- Вставка типовых шаблонов технических требований из JSON-файла
- Редактирование и сохранение технических требований

## Установка и запуск

### Зависимости
- Python 3.x
- win32com (pywin32)
- tkinter (включён в стандартную библиотеку Python)

### Установка зависимостей
```
pip install pywin32
```
или с использованием окружения UV:
```
uv pip install pywin32
```

### Запуск программы
1. Убедитесь, что KOMPAS-3D установлен на вашем компьютере
2. Откройте KOMPAS-3D
3. Запустите программу:
```
python kompas_tech_req_editor.py
```

## Использование программы
1. После запуска программа автоматически подключается к KOMPAS-3D
2. В верхней части окна отображается информация о текущем активном документе
3. В левой панели отображается дерево всех открытых документов в KOMPAS-3D
4. В правой верхней панели представлены шаблоны технических требований, разделенные по категориям
5. В правой нижней панели отображается текущее содержимое технических требований активного документа

### Работа с программой
- Для активации документа дважды кликните по нему в дереве документов
- Для получения технических требований из активного документа нажмите кнопку "Получить требования"
- Для вставки шаблона в текстовое поле с требованиями дважды кликните по шаблону
- Для сохранения отредактированных требований в документ нажмите кнопку "Сохранить требования"
- Для обновления дерева документов нажмите кнопку "Обновить"

## Файл шаблонов
Шаблоны технических требований хранятся в файле `templates.json`, который имеет следующую структуру:
```json
{
    "Категория1": [
        "Шаблон 1",
        "Шаблон 2",
        "..."
    ],
    "Категория2": [
        "Шаблон 1",
        "Шаблон 2",
        "..."
    ],
    "..."
}
```

Вы можете расширять и изменять этот файл в соответствии с вашими потребностями.

## Примечания
- Программа работает с API KOMPAS-3D версии 7
- Для работы с техническими требованиями документ должен быть чертежом
- При сохранении технических требований автоматически включается нумерация пунктов
